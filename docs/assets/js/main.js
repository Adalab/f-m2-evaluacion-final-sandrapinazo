"use strict";const inputEl=document.querySelector("#TVshow"),buttonEl=document.querySelector(".button"),ulfavEl=document.querySelector(".favs"),ulresultsEl=document.querySelector(".results");let favList=[];function btnClickHandler(){ulresultsEl.innerHTML="";const t=inputEl.value;fetch(`http://api.tvmaze.com/search/shows?q=${t}`).then(t=>t.json()).then(function(t){for(const e of t){const{show:t}=e,{id:s,name:n,image:a}=t,l=document.createElement("li");l.classList.add("show"),l.setAttribute("data-id",s);const i=document.createElement("p");i.classList.add("title");const o=document.createTextNode(n);i.appendChild(o);const c=document.createElement("img");if(c.classList.add("image"),a){const{medium:t}=a;c.src=t}else c.src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV";for(let t=0;t<favList.length;t++)parseInt(favList[t].id)===s&&l.classList.add("favshow");l.appendChild(c),l.appendChild(i),l.addEventListener("click",favShow),ulresultsEl.appendChild(l)}})}function favShow(t){const e=t.currentTarget;e.classList.toggle("favshow");const s=e.querySelector("p").innerHTML,n=e.querySelector("img").src,a=e.getAttribute("data-id"),l={id:a,title:s,img:n};if(e.classList.contains("favshow"))favList.push(l);else for(let t=0;t<favList.length;t++)console.log("for"),favList[t].id===a&&favList.splice(t,1);paintFavList(),saveFavs()}function paintFavList(){ulfavEl.innerHTML="";for(const t of favList){const{id:e,title:s,img:n}=t,a=`\n    <li class="show" data-id="${e}">\n        <img src= ${n} alt=${s} class="image">\n        <p class="title">${s}</p>\n        <button class="delete" type="button">X</button>\n    </li>`;ulfavEl.innerHTML+=a}const t=ulfavEl.querySelectorAll(".delete");for(const e of t)e.addEventListener("click",deleteFavBtn)}function saveFavs(){localStorage.setItem("favShowsList",JSON.stringify(favList))}function setfavListFromCache(){const t=JSON.parse(localStorage.getItem("favShowsList"));t&&(favList=t,paintFavList())}function deleteFavBtn(t){const e=t.currentTarget.parentElement,s=e.getAttribute("data-id");console.log(e,"delete",s);for(let t=0;t<favList.length;t++)favList[t].id===s&&(console.log("check"),favList.splice(t,1));paintFavList(),saveFavs()}function handlerEnter(t){t.preventDefault(),console.log(t),"Enter"===t.key&&(t.preventDefault(),btnClickHandler(),console.log("enter"))}setfavListFromCache(),buttonEl.addEventListener("click",btnClickHandler),inputEl.addEventListener("keyup",handlerEnter);